<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inschrijvingsformulier – CoolTravel</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/custom.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
</head>
<body class="bg-gray-50 text-gray-800 font-inter">

<section class="min-h-screen flex items-center justify-center py-20 px-6">
  <div class="bg-white p-10 rounded-xl shadow-2xl w-full max-w-3xl">
    <h1 class="text-3xl font-bold mb-6 text-center">Inschrijvingsformulier</h1>

    <form id="inschrijfformulier" class="space-y-6">
      <!-- Hoofdboeker -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">Naam</label>
          <input type="text" name="naam" required class="form-input">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Voornaam</label>
          <input type="text" name="voornaam" required class="form-input">
        </div>
      </div>

      <!-- Facturatie op bedrijf -->
      <div>
        <label class="inline-flex items-center">
          <input type="checkbox" id="factuur-checkbox" class="form-checkbox text-blue-600">
          <span class="ml-2">Ik wens een factuur op naam van mijn bedrijf</span>
        </label>
      </div>

      <div id="factuur-velden" class="mt-4 space-y-4 hidden">
        <div>
          <label class="block text-sm font-medium mb-1">Bedrijfsnaam</label>
          <input type="text" name="factuur_bedrijfsnaam" class="form-input">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Adres bedrijf</label>
          <input type="text" name="factuur_adres" class="form-input">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">BTW-nummer</label>
          <input type="text" name="factuur_btw" class="form-input">
        </div>
      </div>

      <div>
        <label class="block text-sm font-medium mb-1">Adres</label>
        <input type="text" name="adres" required class="form-input">
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">Postcode</label>
          <input type="text" name="postcode" required class="form-input">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Geboortedatum</label>
          <input type="date" name="geboortedatum" required class="form-input">
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">GSM-nummer</label>
          <input type="tel" name="gsm" required class="form-input">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">E-mailadres</label>
          <input type="email" name="email" required class="form-input">
        </div>
      </div>

      <!-- Verzekering -->
      <div>
        <label class="block text-sm font-medium mb-2">Annulatie- en bijstandsverzekering gewenst?</label>
        <div class="flex items-center gap-6">
          <label class="inline-flex items-center">
            <input type="radio" name="verzekering" value="ja" required class="form-radio text-blue-600">
            <span class="ml-2">Ja</span>
          </label>
          <label class="inline-flex items-center">
            <input type="radio" name="verzekering" value="nee" class="form-radio text-blue-600">
            <span class="ml-2">Nee</span>
          </label>
        </div>
      </div>

      <!-- Reisopties -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">Kies je week</label>
          <select name="week" id="week-select" required class="form-input">
            <option value="">Selecteer week</option>
            <option value="1-6 maart 2026">1 – 6 maart 2026</option>
            <option value="8-13 maart 2026">8 – 13 maart 2026</option>
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Aantal nachten</label>
          <select name="nachten" id="nachten-select" required class="form-input">
            <option value="">Aantal nachten</option>
            <option value="4">4 nachten</option>
            <option value="5">5 nachten</option>
            <option value="6">Volledige week (6 nachten)</option>
          </select>
        </div>
      </div>

      <div id="aankomstdatum-veld" class="mt-4 hidden">
        <label class="block text-sm font-medium mb-1">Aankomstdatum (binnen gekozen week)</label>
        <input type="date" name="aankomstdatum" class="form-input">
      </div>

      <!-- Reizigers -->
      <div>
        <h2 class="text-lg font-semibold mt-6 mb-2">Gegevens van alle reizigers</h2>
        <div id="reizigers-container" class="space-y-4"></div>
        <button type="button" id="add-reiziger" class="mt-2 text-blue-600 hover:underline">+ Reiziger toevoegen</button>
      </div>

      <!-- Versturen -->
      <div class="pt-4">
        <button type="submit" class="btn-primary w-full">Inschrijving versturen</button>
      </div>
    </form>

    <div id="bevestiging" class="text-center text-green-600 font-medium mt-4 hidden">✅ Inschrijving succesvol verzonden!</div>
  </div>
</section>

<script>
const container = document.getElementById('reizigers-container');
const btnAdd = document.getElementById('add-reiziger');
let reizigerIndex = 0;

function createReizigerBlock() {
  const div = document.createElement('div');
  div.className = "bg-gray-50 p-4 rounded border relative group";

  div.innerHTML = `
    <button type="button" class="absolute top-2 right-2 text-red-600 font-bold text-xl" title="Verwijderen">×</button>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium mb-1">Naam + voornaam</label>
        <input type="text" name="reiziger_naam_${reizigerIndex}" required class="form-input">
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Geboortedatum</label>
        <input type="date" name="reiziger_geboortedatum_${reizigerIndex}" required class="form-input">
      </div>
    </div>
    <div class="mt-3">
      <label class="block text-sm font-medium mb-1">Kamertype</label>
      <select name="reiziger_kamer_${reizigerIndex}" required class="form-input">
        <option value="">Selecteer kamer</option>
        <option value="2-persoons standaardkamer">2-persoons standaardkamer</option>
        <option value="2-persoons superior kamer">2-persoons superior kamer</option>
        <option value="1 persoon op 2-persoons standaardkamer (single gebruik)">1 persoon op 2-persoons standaardkamer (single gebruik)</option>
      </select>
    </div>
  `;

  // Voeg delete-functionaliteit toe
  const deleteButton = div.querySelector("button");
  deleteButton.addEventListener("click", () => {
    div.remove();
  });

  container.appendChild(div);
  reizigerIndex++;
}


btnAdd.addEventListener('click', createReizigerBlock);
createReizigerBlock();

const form = document.getElementById('inschrijfformulier');
form.addEventListener('submit', function (e) {
  e.preventDefault();
  const formData = new FormData(form);
  const data = {};
  for (const [key, value] of formData.entries()) {
    data[key] = value;
  }

  fetch("/api/submit", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => {
    if (res.ok) {
      form.reset();
      container.innerHTML = "";
      createReizigerBlock();
      document.getElementById("bevestiging").classList.remove("hidden");
    } else {
      alert("Er ging iets mis met het versturen van je inschrijving.");
    }
  })
  .catch(err => {
    console.error(err);
    alert("Netwerkfout. Probeer opnieuw.");
  });
});

const nachtenSelect = document.getElementById('nachten-select');
const aankomstVeld = document.getElementById('aankomstdatum-veld');
const aankomstInput = aankomstVeld.querySelector('input');

nachtenSelect.addEventListener('change', () => {
  if (nachtenSelect.value === "4" || nachtenSelect.value === "5") {
    aankomstVeld.classList.remove('hidden');
    aankomstInput.required = true;
  } else {
    aankomstVeld.classList.add('hidden');
    aankomstInput.required = false;
    aankomstInput.value = "";
  }
});

const factuurCheckbox = document.getElementById('factuur-checkbox');
const factuurVelden = document.getElementById('factuur-velden');

factuurCheckbox.addEventListener('change', () => {
  factuurVelden.classList.toggle('hidden', !factuurCheckbox.checked);
});
</script>

</body>
</html>
