<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Inschrijvingsformulier â€“ CoolTravel</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="css/custom.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet" />
</head>
<body class="bg-gray-50 text-gray-800 font-inter">

<section class="min-h-screen flex items-center justify-center py-20 px-6">
  <div class="bg-white p-10 rounded-xl shadow-2xl w-full max-w-3xl">
    <h1 class="text-3xl font-bold mb-6 text-center break-words text-balance">Inschrijvingsformulier</h1>


    <form id="inschrijfformulier" class="space-y-6">
      <!-- Hoofdboeker -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">Naam</label>
          <input type="text" name="naam" required class="form-input">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Voornaam</label>
          <input type="text" name="voornaam" required class="form-input">
        </div>
      </div>

      <!-- Facturatie op bedrijf -->
<div>
  <label class="inline-flex items-center">
    <input type="checkbox" id="factuur-checkbox" class="form-checkbox text-blue-600">
    <span class="ml-2">Ik wens een factuur op naam van mijn bedrijf</span>
  </label>
</div>

<div id="factuur-velden" class="mt-4 space-y-4 hidden bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-md shadow-sm">
  <h2 class="text-md font-semibold text-yellow-800 mb-2">Facturatiegegevens bedrijf</h2>
  <div>
    <label class="block text-sm font-medium mb-1 text-yellow-900">Bedrijfsnaam</label>
    <input type="text" name="factuur_bedrijfsnaam" class="form-input bg-yellow-100 border-yellow-300 focus:ring-yellow-500 focus:border-yellow-500">
  </div>
  <div>
    <label class="block text-sm font-medium mb-1 text-yellow-900">Adres bedrijf</label>
    <input type="text" name="factuur_adres" class="form-input bg-yellow-100 border-yellow-300 focus:ring-yellow-500 focus:border-yellow-500">
  </div>
  <div>
    <label class="block text-sm font-medium mb-1 text-yellow-900">BTW-nummer</label>
    <input type="text" name="factuur_btw" class="form-input bg-yellow-100 border-yellow-300 focus:ring-yellow-500 focus:border-yellow-500">
  </div>
</div>


      <div>
        <label class="block text-sm font-medium mb-1">Adres</label>
        <input type="text" name="adres" required class="form-input">
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">Postcode</label>
          <input type="text" name="postcode" required class="form-input">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">Geboortedatum</label>
          <input type="date" name="geboortedatum" required class="form-input">
        </div>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-sm font-medium mb-1">GSM-nummer</label>
          <input type="tel" name="gsm" required class="form-input">
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">E-mailadres</label>
          <input type="email" name="email" required class="form-input">
        </div>
      </div>

      <!-- Verzekering -->
      <div>
        <label class="block text-sm font-medium mb-2">Annulatie- en bijstandsverzekering gewenst?</label>
        <div class="flex items-center gap-6">
          <label class="inline-flex items-center">
            <input type="radio" name="verzekering" value="ja" required class="form-radio text-blue-600">
            <span class="ml-2">Ja</span>
          </label>
          <label class="inline-flex items-center">
            <input type="radio" name="verzekering" value="nee" class="form-radio text-blue-600">
            <span class="ml-2">Nee</span>
          </label>
        </div>
      </div>

      <!-- Reisopties -->
<div class="grid grid-cols-1 md:grid-cols-2 gap-4">
  <div>
    <label class="block text-sm font-medium mb-1">Kies je week</label>
    <select name="week" id="week-select" required class="form-input">
      <option value="">Selecteer week</option>
      <option value="1-6 maart 2026">1 â€“ 6 maart 2026</option>
      <option value="8-15 maart 2026">8 â€“ 15 maart 2026</option>
    </select>
  </div>
  <div>
    <label class="block text-sm font-medium mb-1">Aantal nachten</label>
    <select name="nachten" id="nachten-select" required class="form-input">
      <option value="">Aantal nachten</option>
      <option value="4">4 nachten</option>
      <option value="5">5 nachten</option>
      <option value="6">6 nachten</option>
      <option value="7">7 nachten</option>
    </select>
  </div>
</div>


      <div id="aankomstdatum-veld" class="mt-4 hidden">
  <label class="block text-sm font-medium mb-1">Aankomstdatum (binnen gekozen week)</label>
  <select name="aankomstdatum" id="aankomst-select" class="form-input"></select>
</div>


      <!-- Reizigers -->
      <div>
        <h2 class="text-lg font-semibold mt-6 mb-2">Gegevens van alle reizigers</h2>
        <div id="reizigers-container" class="space-y-4"></div>
        <button type="button" id="add-reiziger" class="mt-2 text-blue-600 hover:underline">+ Reiziger toevoegen</button>
      </div>

      <!-- Totaalprijs -->
<div id="totaalprijs" class="text-right text-lg font-semibold text-blue-700 pt-4">Totaalprijs: â‚¬0</div>


      <!-- Versturen -->
      <div class="pt-4">
        <button type="submit" class="btn-primary w-full">Inschrijving versturen</button>
      </div>
    </form>

    <div id="bevestiging" class="text-center text-green-600 font-medium mt-4 hidden">âœ… Inschrijving succesvol verzonden!</div>
  </div>
</section>

<script>
const prijzen = {
  "1-6 maart 2026": {
    "4": {
      "2-persoons standaardkamer": 1061,
      "2-persoons superior kamer": 1237,
      "1 persoon op 2-persoonskamer (single gebruik)": 1000
    },
    "5": {
      "2-persoons standaardkamer": 1211,
      "2-persoons superior kamer": 1537,
      "1 persoon op 2-persoonskamer (single gebruik)": 1000
    }
  },
  "8-15 maart 2026": {
    "4": {
      "2-persoons standaardkamer": 853,
      "2-persoons superior kamer": 989,
      "1 persoon op 2-persoonskamer (single gebruik)": 1000
    },
    "5": {
      "2-persoons standaardkamer": 1052,
      "2-persoons superior kamer": 1222,
      "1 persoon op 2-persoonskamer (single gebruik)": 1000
    },
    "6": {
      "2-persoons standaardkamer": 1239,
      "2-persoons superior kamer": 1443,
      "1 persoon op 2-persoonskamer (single gebruik)": 1000
    },
    "7": {
      "2-persoons standaardkamer": 1390,
      "2-persoons superior kamer": 1628,
      "1 persoon op 2-persoonskamer (single gebruik)": 1000
    }
  }
};

const container = document.getElementById('reizigers-container');
const btnAdd = document.getElementById('add-reiziger');
let reizigerIndex = 0;

function createReizigerBlock() {
  const div = document.createElement('div');
  div.className = "reiziger-blok bg-gray-50 p-4 rounded border relative group";

  div.innerHTML = `
    <button type="button" class="absolute top-2 right-2 text-red-600 font-bold text-xl" title="Verwijderen">Ã—</button>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-medium mb-1">Naam + voornaam</label>
        <input type="text" name="reiziger_naam_${reizigerIndex}" required class="form-input">
      </div>
      <div>
        <label class="block text-sm font-medium mb-1">Geboortedatum</label>
        <input type="date" name="reiziger_geboortedatum_${reizigerIndex}" required class="form-input">
      </div>
    </div>
    <div class="mt-3">
      <label class="block text-sm font-medium mb-1">Kamertype</label>
      <select name="reiziger_kamer_${reizigerIndex}" required class="form-input kamerkeuze">
        <option value="">Selecteer kamer</option>
        <option value="2-persoons standaardkamer">2-persoons standaardkamer</option>
        <option value="2-persoons superior kamer">2-persoons superior kamer</option>
        <option value="1 persoon op 2-persoonskamer (single gebruik)">1 persoon op 2-persoonskamer (single gebruik)</option>
      </select>
      <div class="prijs-info text-sm mt-2 text-blue-600 font-medium"></div>
    </div>
  `;

  // verwijderen
  div.querySelector("button").addEventListener("click", () => {
    div.remove();
    updateTotaalPrijs();
  });

  // kamerkeuze = prijs updaten
  div.querySelector(".kamerkeuze").addEventListener("change", updateTotaalPrijs);

  container.appendChild(div);
  reizigerIndex++;
  updateTotaalPrijs();
}

function updateTotaalPrijs() {
  const week = document.getElementById('week-select').value;
  const nachten = document.getElementById('nachten-select').value;
  let totaal = 0;

  container.querySelectorAll('.reiziger-blok').forEach(blok => {
    const kamerSelect = blok.querySelector('select');
    const prijsEl = blok.querySelector('.prijs-info');
    const kamer = kamerSelect.value;

    const prijs = prijzen[week]?.[nachten]?.[kamer] || 0;
    prijsEl.textContent = prijs ? `ðŸ’° â‚¬${prijs}` : '';
    totaal += prijs;
  });

  document.getElementById('totaalprijs').textContent = `ðŸ’° Totaalprijs: â‚¬${totaal}`;
}

btnAdd.addEventListener('click', createReizigerBlock);
createReizigerBlock();

const form = document.getElementById('inschrijfformulier');
form.addEventListener('submit', function (e) {
  e.preventDefault();
  const formData = new FormData(form);
  const data = {};
for (const [key, value] of formData.entries()) {
  data[key] = value;
}

// Haal totaalprijs op als numeriek bedrag
const totaalText = document.getElementById('totaalprijs').textContent;
const totaalGetal = parseInt(totaalText.replace(/[^\d]/g, '')) || 0;
data.totaalprijs = totaalGetal;


  fetch("/api/submit", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  })
  .then(res => {
    if (res.ok) {
      form.reset();
      container.innerHTML = "";
      reizigerIndex = 0;
      createReizigerBlock();
      document.getElementById("bevestiging").classList.remove("hidden");
      updateTotaalPrijs();
    } else {
      alert("Er ging iets mis met het versturen van je inschrijving.");
    }
  })
  .catch(err => {
    console.error(err);
    alert("Netwerkfout. Probeer opnieuw.");
  });
});

const weekSelect = document.getElementById('week-select');
const nachtenSelect = document.getElementById('nachten-select');
const aankomstVeld = document.getElementById('aankomstdatum-veld');
const aankomstSelect = document.getElementById('aankomst-select');

function updateNachtenOptions() {
  nachtenSelect.innerHTML = `<option value="">Aantal nachten</option>`;

  if (weekSelect.value === "1-6 maart 2026") {
    nachtenSelect.innerHTML += `<option value="4">4 nachten</option>`;
    nachtenSelect.innerHTML += `<option value="5">5 nachten</option>`;
  } else if (weekSelect.value === "8-15 maart 2026") {
    nachtenSelect.innerHTML += `<option value="4">4 nachten</option>`;
    nachtenSelect.innerHTML += `<option value="5">5 nachten</option>`;
    nachtenSelect.innerHTML += `<option value="6">6 nachten</option>`;
    nachtenSelect.innerHTML += `<option value="7">7 nachten</option>`;
  }

  updateAankomstDatum();
  updateTotaalPrijs();
}

function updateAankomstDatum() {
  const week = weekSelect.value;
  const nachten = nachtenSelect.value;

  aankomstSelect.innerHTML = "";
  const opties = [];

  if (week === "1-6 maart 2026") {
    if (nachten === "4") {
      opties.push(["2026-03-01", "1 maart 2026 (zondag)"]);
      opties.push(["2026-03-02", "2 maart 2026 (maandag)"]);
    } else {
      aankomstVeld.classList.add('hidden');
      aankomstSelect.required = false;
      return;
    }
  }

  if (week === "8-15 maart 2026") {
    if (nachten === "4") {
      opties.push(["2026-03-08", "8 maart 2026 (zondag)"]);
      opties.push(["2026-03-09", "9 maart 2026 (maandag)"]);
      opties.push(["2026-03-10", "10 maart 2026 (dinsdag)"]);
      opties.push(["2026-03-11", "11 maart 2026 (woensdag)"]);
    } else if (nachten === "5") {
      opties.push(["2026-03-08", "8 maart 2026 (zondag)"]);
      opties.push(["2026-03-09", "9 maart 2026 (maandag)"]);
      opties.push(["2026-03-10", "10 maart 2026 (dinsdag)"]);
    } else if (nachten === "6") {
      opties.push(["2026-03-08", "8 maart 2026 (zondag)"]);
      opties.push(["2026-03-09", "9 maart 2026 (maandag)"]);
    }
  }

  if (opties.length > 0) {
    aankomstVeld.classList.remove('hidden');
    aankomstSelect.required = true;
    aankomstSelect.innerHTML = `<option value="">Selecteer aankomstdatum</option>`;
    opties.forEach(([val, label]) => {
      const opt = document.createElement("option");
      opt.value = val;
      opt.textContent = label;
      aankomstSelect.appendChild(opt);
    });
  } else {
    aankomstVeld.classList.add('hidden');
    aankomstSelect.required = false;
  }
} 

weekSelect.addEventListener('change', updateNachtenOptions);
nachtenSelect.addEventListener('change', () => {
  updateAankomstDatum();
  updateTotaalPrijs();
});

const factuurCheckbox = document.getElementById('factuur-checkbox');
const factuurVelden = document.getElementById('factuur-velden');
factuurCheckbox.addEventListener('change', () => {
  factuurVelden.classList.toggle('hidden', !factuurCheckbox.checked);
});
</script>



</body>
</html>
